"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[86],{8086:(e,t,s)=>{s.r(t),s.d(t,{default:()=>j});var a=s(5043),l=s(6058),r=s(3216),n=s(5475),o=s(3003),c=s(7488),i=s(8529),d=s(3032),u=s(6868);var x=s(3910),m=s(7929),h=s(9563),g=s(1552),f=s(9804),p=s(5752),y=(s(9492),s(1183)),v=s(579);const j=()=>{const e=(0,o.wA)(),[t,s]=(0,a.useState)(!1),[j,w]=(0,a.useState)(!1),{user:b}=(0,o.d4)((e=>e.user)),{soundEnabled:N,toggleSound:k}=(0,u.f)(),{token:C}=(0,a.useContext)(d.Ay),S=(0,r.Zp)(),_=(0,r.zy)(),[A,T]=(0,a.useState)(0),[I,E]=(0,a.useState)(!1),[R,M]=(0,a.useState)(""),[P,z]=(0,a.useState)(!1),L=(0,a.useRef)(null),q=(0,a.useMemo)((()=>new URLSearchParams(_.search).get("q")||""),[_]),[U,$]=(0,a.useState)(q),B=((e,t)=>{const[s,l]=(0,a.useState)(e);return(0,a.useEffect)((()=>{const s=setTimeout((()=>{l(e)}),t);return()=>{clearTimeout(s)}}),[e,t]),s})(U,300),D=(0,a.useCallback)((async()=>{if(null!==b&&void 0!==b&&b._id)try{const e=await fetch(g.A.notificationCount.url,{credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();t.success&&T(t.count)}catch(e){console.error("\u274c Error fetching unread count:",e)}}),[null===b||void 0===b?void 0:b._id]),G=(0,a.useCallback)((async()=>{if(null!==b&&void 0!==b&&b._id)try{const e=await fetch(g.A.getNewNotifications.url,{credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();if(t.success&&Array.isArray(t.newNotifications)){const e=t.newNotifications[0],s=localStorage.getItem("lastNotifiedId");e&&e._id!==s&&(localStorage.setItem("lastNotifiedId",e._id),M(e.message||"New notification received!"),E(!0),z(!0),N&&L.current&&(L.current.currentTime=0,L.current.play().catch((e=>{console.warn("Notification sound failed:",e)}))),navigator.vibrate&&navigator.vibrate([100,50,100]),setTimeout((()=>z(!1)),2e3),setTimeout((()=>E(!1)),4e3))}}catch(e){console.error("\u274c Error fetching new notifications:",e)}}),[null===b||void 0===b?void 0:b._id]);(0,a.useEffect)((()=>{B.trim()&&S(`/search?q=${encodeURIComponent(B)}`)}),[B,S]);const K=(0,a.useCallback)((async()=>{w(!0);try{const t=await fetch(g.A.logout_user.url,{method:g.A.logout_user.method,credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${C}`}}),s=await t.json();s.success?(c.oR.success(s.message),e((0,i.m5)(null)),S("/")):c.oR.error(s.message)}catch(t){c.oR.error("Logout failed. Please try again.")}finally{w(!1)}}),[e,S,C]);(0,a.useEffect)((()=>{D(),G();const e=setInterval(D,5e3),t=setInterval(G,5e3);return()=>{clearInterval(e),clearInterval(t)}}),[D,G]);(0,a.useMemo)((()=>((e,t)=>{const s=e.split(/\s+/);return s.length>t?{truncated:s.slice(0,t).join(" ")+"...",original:e,isTruncated:!0}:{truncated:e,original:e,isTruncated:!1}})(R,10)),[R]);return(0,v.jsxs)("header",{className:"fixed z-40 bg-white text-black right-0 left-0 top-0 px-4 sm:px-6 lg:px-8 shadow-sm flex flex-col gap-2 sm:mt-9 md:mt-9 lg:mt-9 mt-9 ",children:[" ",(0,v.jsx)("div",{className:"flex items-center justify-between min-h-[48px]",children:(0,v.jsxs)("div",{className:"flex items-center justify-between md:mt-1 md:pt-1 lg:mt-1 lg:pt-1 w-full",children:[(0,v.jsxs)("div",{className:"flex items-center gap-4",children:[(0,v.jsxs)("button",{onClick:()=>s((e=>!e)),className:"text-gray-700 mt-1 md:hidden",children:[(0,v.jsx)(x.g,{icon:m.ckx,className:"h-6 w-6 glossy-text"})," "]}),(0,v.jsx)("div",{className:"md:hidden flex-1 flex items-center mt-1 justify-center",children:(0,v.jsxs)("div",{className:"flex items-center ml-4 py-1 w-full max-w-[200px]",children:[(0,v.jsx)(f.iyI,{className:"text-yellow-700 h-4 w-4 mr-1 glossy-text"}),(0,v.jsx)("input",{type:"text",placeholder:"gift cards, vc, cc....",className:"bg-transparent text-black text-xs outline-none w-full placeholder:text-[14px] placeholder-gray-500 glossy-text",value:U,onChange:e=>$(e.target.value)})]})})]}),(0,v.jsx)(n.N_,{to:"/home",className:"relative hidden md:flex items-center font-bold text-yellow-600 tracking-wide",children:(0,v.jsx)("div",{className:" flex py-1 flex-col justify-center",children:(0,v.jsxs)("div",{className:"relative py-2  sm:mx-auto ",children:[(0,v.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-emerald-400 to-blue-500 shadow-lg transform rounded-3xl border-4 border-yellow-700"}),(0,v.jsx)("div",{className:"relative px-4 p-1.5 bg-white shadow-lg rounded-2xl sm:p-1.5 border-4 border-yellow-700",children:(0,v.jsx)("div",{className:"",children:(0,v.jsx)("div",{className:"grid grid-cols-1",children:(0,v.jsx)(y.A,{type:"button"})})})})]})})}),(0,v.jsxs)("div",{className:"hidden md:flex gap-3 items-center",children:["/search"===_.pathname&&(0,v.jsxs)("button",{onClick:()=>S(-1),className:"text-yellow-600 hover:text-yellow-800",children:[(0,v.jsx)(x.g,{icon:m.CeG,className:"h-5 w-5 glossy-text"})," "]}),(0,v.jsxs)("div",{className:"flex items-center  px-3 py-1 w-64",children:[(0,v.jsx)(l.Mwp,{className:"text-gray-600 h-4 w-4 mr-2 glossy-text"}),(0,v.jsx)("input",{type:"text",placeholder:"gift cards, vc, cc...",className:"bg-transparent text-black text-sm outline-none w-full placeholder:text-sm placeholder-gray-500 glossy-text",value:U,onChange:e=>$(e.target.value)})]}),(0,v.jsxs)("nav",{className:"flex items-center justify-between mx-auto gap-3 text-xs",children:[(0,v.jsxs)(n.N_,{to:"/record",className:"px-2 py-1 border-4 border-cyan-700 text-black hover:bg-cyan-600 hover:text-black rounded glossy-text",children:[" ","Trade Status"]}),(0,v.jsxs)(n.N_,{to:"/datapad",className:"px-3 py-1 border-4 border-yellow-700 text-black hover:bg-yellow-500 hover:text-black rounded glossy-text",children:[" ","DataPad"]})]})]}),(0,v.jsx)("button",{onClick:k,className:"px-3 py-1  ml-4  text-black hover:text-blue-500 rounded flex items-center glossy-text",children:(0,v.jsx)(x.g,{icon:N?m.jY_:m.PKk,className:"mr-1"})})]})}),(0,v.jsx)("audio",{ref:L,src:h,preload:"auto"}),(0,v.jsx)(p.A,{open:t,setOpen:s,handleLogout:K,loading:j,onCloseMenu:()=>s(!1)})]})}}}]);
//# sourceMappingURL=86.84be869e.chunk.js.map