"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[664],{4664:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var r=a(5043),s=a(6058),n=a(3216),o=a(5475),l=a(3003),i=a(7488),c=a(8529),d=a(3032),u=a(6868);var x=a(3910),h=a(7929),m=a(3002),p=a(9563),f=a(1552),g=a(9804),b=a(5459),w=(a(7611),a(579));const v=()=>{const e=(0,l.wA)(),[t,a]=(0,r.useState)(!1),[v,y]=(0,r.useState)(!1),{user:j}=(0,l.d4)((e=>e.user)),{soundEnabled:N,toggleSound:k}=(0,u.f)(),{token:S}=(0,r.useContext)(d.Ay),C=(0,n.Zp)(),_=(0,n.zy)(),[T,I]=(0,r.useState)(0),[A,E]=(0,r.useState)(!1),[R,M]=(0,r.useState)(""),[P,z]=(0,r.useState)(!1),D=(0,r.useRef)(null),L=(0,r.useMemo)((()=>new URLSearchParams(_.search).get("q")||""),[_]),[O,q]=(0,r.useState)(L),K=((e,t)=>{const[a,s]=(0,r.useState)(e);return(0,r.useEffect)((()=>{const a=setTimeout((()=>{s(e)}),t);return()=>{clearTimeout(a)}}),[e,t]),a})(O,300),U=()=>{N&&D.current&&(D.current.currentTime=0,D.current.play().catch((e=>{console.warn("Notification sound failed:",e)})))},Y=()=>{navigator.vibrate&&navigator.vibrate([100,50,100])},$=(0,r.useCallback)((async()=>{if(null!==j&&void 0!==j&&j._id)try{const e=await fetch(f.A.notificationCount.url,{credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();t.success&&I(t.count)}catch(e){console.error("\u274c Error fetching unread count:",e)}}),[null===j||void 0===j?void 0:j._id]),B=(0,r.useCallback)((async()=>{if(null!==j&&void 0!==j&&j._id)try{const e=await fetch(f.A.getNewNotifications.url,{credentials:"include",headers:{"Content-Type":"application/json"}}),t=await e.json();if(t.success&&Array.isArray(t.newNotifications)){const e=t.newNotifications[0],a=localStorage.getItem("lastNotifiedId");e&&e._id!==a&&(localStorage.setItem("lastNotifiedId",e._id),M(e.message||"New notification received!"),E(!0),z(!0),U(),Y(),setTimeout((()=>z(!1)),2e3),setTimeout((()=>E(!1)),4e3))}}catch(e){console.error("\u274c Error fetching new notifications:",e)}}),[null===j||void 0===j?void 0:j._id,U,Y]);(0,r.useEffect)((()=>{K.trim()&&C(`/search?q=${encodeURIComponent(K)}`)}),[K,C]),(0,r.useEffect)((()=>{$(),B();const e=setInterval($,5e3),t=setInterval(B,5e3);return()=>{clearInterval(e),clearInterval(t)}}),[$,B]);const F=(0,r.useCallback)((async()=>{y(!0);try{const t=await fetch(f.A.logout_user.url,{method:f.A.logout_user.method,credentials:"include",headers:{"Content-Type":"application/json",Authorization:`Bearer ${S}`}}),a=await t.json();a.success?(i.oR.success(a.message),e((0,c.m5)(null)),C("/")):i.oR.error(a.message)}catch(t){i.oR.error("Logout failed. Please try again.")}finally{y(!1)}}),[e,C,S]),G=(0,r.useCallback)((()=>a((e=>!e))),[]),H=(0,r.useCallback)((()=>a(!1)),[]),X=(0,r.useMemo)((()=>((e,t)=>{const a=e.split(/\s+/);return a.length>t?{truncated:a.slice(0,t).join(" ")+"...",original:e,isTruncated:!0}:{truncated:e,original:e,isTruncated:!1}})(R,10)),[R]);return(0,r.useEffect)((()=>{console.log("Header soundEnabled:",N)}),[N]),(0,w.jsx)(w.Fragment,{children:(0,w.jsxs)("header",{className:"header-spa left-0 right-0 top-0 pt-8 mb-8 inset-0 bg-black/80 backdrop-blur-md fixed w-full z-40 border-b border-white/20 shadow-md transition-all duration-300 flex items-center justify-between px-4 sm:px-6 lg:px-8",children:[(0,w.jsxs)("div",{className:"w-full mx-auto flex items-center justify-between",children:[(0,w.jsx)("div",{className:"flex items-center gap-2",children:(0,w.jsx)("button",{onClick:G,className:"text-gray-500 hover:text-blue-600 md:hidden","aria-expanded":t,children:(0,w.jsx)(x.g,{icon:h.ckx,className:"h-5 w-5"})})}),(0,w.jsx)(o.N_,{to:"/home",className:"hidden md:flex items-center font-bold text-transparent text-2xl bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-500 to-pink-500 tracking-wide",children:(0,w.jsxs)("div",{className:"logo-wrapper",children:[(0,w.jsx)("h1",{className:"logo-text font-extrabold tracking-wide text-transparent bg-clip-text bg-gradient-to-r from-cyan-400 via-purple-500 to-pink-500",children:"SXN"}),(0,w.jsx)("div",{className:"logo-accent"})]})}),(0,w.jsxs)("div",{className:"hidden md:flex items-center bg-black border-2 rounded-md px-4 py-[6px] w-72 glow-border",children:[(0,w.jsx)(s.Mwp,{className:"text-white h-5 w-5 mr-2"}),(0,w.jsx)("input",{type:"text",placeholder:"Search gift cards, deals, offers...",className:"bg-transparent minecraft-font text-white text-[12px] outline-none w-full placeholder:text-[8px] placeholder-gray-600",value:O,onChange:e=>q(e.target.value)})]}),(0,w.jsx)("div",{className:"md:hidden flex items-center w-full mx-4",children:(0,w.jsxs)("div",{className:"flex items-center bg-black border-2 rounded-md px-2 py-[6px] w-full glow-border",children:[(0,w.jsx)(g.iyI,{className:"text-yellow-700 h-5 w-5 mr-2"}),(0,w.jsx)("input",{type:"text",placeholder:"Search gift cards...",className:"bg-transparent minecraft-font text-white text-[12px] outline-none w-full placeholder:text-[8px] placeholder-gray-600",value:O,onChange:e=>q(e.target.value)})]})}),(0,w.jsxs)("nav",{className:"hidden minecraft-font text-[9px] md:flex items-center gap-2",children:[(0,w.jsx)(o.N_,{to:"/record",className:"px-3 py-1 border border-cyan-500 text-gray-900 hover:bg-cyan-600 hover:text-white rounded transition duration-200",children:"Trade Status"}),(0,w.jsx)(o.N_,{to:"/datapad",className:"px-3 py-1 border border-yellow-500 text-gray-900 hover:bg-yellow-500 hover:text-black rounded transition duration-200",children:"DataPad"}),(0,w.jsxs)(o.N_,{to:"/notifications",className:"relative px-3 py-1 border border-emerald-500 text-gray-900 hover:bg-emerald-600 hover:text-white rounded transition duration-200",children:[(0,w.jsx)(m.fmI,{className:P?"animate-ping-slow text-2xl":"text-2xl"}),T>0&&(0,w.jsx)("span",{className:"absolute -top-1 -right-1 bg-red-600 text-white text-xs px-1.5 py-0.5 rounded-full",children:T})]}),(null===j||void 0===j?void 0:j._id)&&(0,w.jsxs)("button",{onClick:F,disabled:v,className:"px-3 py-1 border border-red-500 text-gray-900 hover:bg-red-600 hover:text-white rounded transition flex items-center",children:[(0,w.jsx)(x.g,{icon:h.GxD,className:"mr-1"}),"Logout"]}),(0,w.jsxs)("button",{onClick:k,className:"px-3 py-1 border border-gray-500 text-gray-900 hover:bg-gray-600 hover:text-white rounded transition flex items-center",title:N?"Disable Sound":"Enable Sound",children:[(0,w.jsx)(x.g,{icon:N?h.jY_:h.PKk,className:"mr-1"}),(0,w.jsx)("span",{className:"hidden sm:inline",children:N?"Sound On":"Sound Off"})]})]}),(0,w.jsx)("div",{className:"md:hidden flex items-center ml-4",children:(0,w.jsx)("button",{onClick:k,className:"text-gray-500 hover:text-blue-600",title:N?"Disable Sound":"Enable Sound",children:(0,w.jsx)(x.g,{icon:N?h.jY_:h.PKk,className:"h-5 w-5"})})})]}),A&&(0,w.jsxs)("div",{className:"pop-alert w-screen right-0 left-0 bg-white text-black items-center justify-center px-4 py-10 -mt-2 shadow-lg animate-slide-in z-50",children:[(0,w.jsx)("p",{className:"text-sm font-medium",children:X.truncated}),X.isTruncated&&(0,w.jsx)(o.N_,{to:"/notifications",className:"block text-blue-500 hover:underline text-xs",children:"Read More"})]}),(0,w.jsx)("audio",{ref:D,src:p,preload:"auto"}),(0,w.jsx)(b.A,{open:t,setOpen:a,handleLogout:F,loading:v,onCloseMenu:H})]})})}}}]);
//# sourceMappingURL=664.5dcc955d.chunk.js.map